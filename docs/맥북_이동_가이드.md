# 맥북 이동 가이드

**목적**: 현재 Windows 개발 환경에서 작업한 내용을 24시간 켜놓을 맥북으로 이동

---

## 1. GitHub에서 프로젝트 받기

```bash
# 프로젝트 클론
git clone https://github.com/your-username/webtoon_ranking_for_claude.git
cd webtoon_ranking_for_claude

# 브랜치 확인
git branch -a
git checkout main  # 또는 작업 브랜치
```

---

## 2. Python 환경 설정

```bash
# Python 3.9 이상 확인
python3 --version

# 가상환경 생성
python3 -m venv venv

# 가상환경 활성화 (macOS)
source venv/bin/activate

# 패키지 설치
pip install -r requirements.txt

# Playwright 브라우저 설치
playwright install chromium
```

---

## 3. 데이터 초기화

### 3.1 DB 초기화
```bash
python3 -c "from crawler.db import init_db; init_db()"

# 확인
ls -lh data/rankings.db
```

### 3.2 Riverse 작품 데이터 추출
```bash
python3 scripts/extract_riverse_titles.py

# 확인
cat data/riverse_titles.json | head -20
```

---

## 4. 크롤링 테스트

### 4.1 전체 크롤러 실행
```bash
python3 crawler/main.py
```

**예상 결과 (일본 IP 있는 경우):**
```
✅ piccoma: 27개 작품
✅ linemanga: 50개 작품  # Windows에서는 실패했지만 맥북(일본 IP)에서는 성공
❌ mechacomic: 0개 작품  # selector 디버깅 필요
✅ cmoa: 50개 작품
```

### 4.2 개별 에이전트 테스트 (선택사항)
```bash
# Piccoma 테스트
python3 -m crawler.agents.piccoma_agent

# Linemanga 테스트
python3 -m crawler.agents.linemanga_agent

# Mechacomic 디버깅 (headless=False)
python3 -m crawler.agents.mechacomic_agent
```

---

## 5. 대시보드 실행

```bash
streamlit run dashboard/app.py
```

**접속**: http://localhost:8501

**확인 사항:**
- [ ] 날짜 선택 작동
- [ ] 4개 플랫폼 탭 표시
- [ ] 데이터 테이블 표시
- [ ] 링크 클릭 작동

---

## 6. Phase 2: 24/7 자동 실행 설정

### 6.1 Launchd 설정 파일 생성

```bash
# 설정 파일 디렉토리 생성
mkdir -p config/launchd

# plist 파일 작성 (이미 프로젝트에 포함되어 있을 예정)
# config/launchd/com.riverse.webtoon.plist
```

### 6.2 Launchd 설치
```bash
# 설치 스크립트 실행 (Phase 2에서 생성 예정)
./scripts/setup_launchd.sh

# 또는 수동 설치
cp config/launchd/com.riverse.webtoon.plist ~/Library/LaunchAgents/
launchctl load ~/Library/LaunchAgents/com.riverse.webtoon.plist
```

### 6.3 확인
```bash
# 실행 중인지 확인
launchctl list | grep webtoon

# 수동 실행 테스트
launchctl start com.riverse.webtoon.crawler

# 로그 확인
tail -f logs/crawler/stdout.log
```

---

## 7. Health Check 설정

```bash
# Health check 실행 (Phase 2에서 생성 예정)
python3 scripts/health_check.py
```

**예상 출력:**
```
✅ Database: Last crawl: 2026-02-16
✅ Disk Space: 50.23GB
✅ Log Files: Log sizes OK
```

---

## 8. 트러블슈팅

### 문제 1: Python 버전
```bash
# Python 3.14가 너무 높을 경우
# Homebrew로 Python 3.11 설치
brew install python@3.11

# 가상환경 재생성
python3.11 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 문제 2: Playwright 설치 오류
```bash
# 권한 문제 해결
playwright install --with-deps chromium

# 또는
sudo playwright install-deps
playwright install chromium
```

### 문제 3: IP 제한 (Linemanga)
- 일본 IP 확인: https://whatismyipaddress.com/
- VPN 연결 필요 시: ProtonVPN 일본 서버
- 또는: 일본 사무실 맥북에서만 실행

### 문제 4: Mechacomic 데이터 0개
```bash
# headless=False로 디버깅
# mechacomic_agent.py에서:
# browser = await p.chromium.launch(headless=False)

python3 -m crawler.agents.mechacomic_agent
```

---

## 9. 일일 운용 체크리스트

### 아침 (매일 JST 09:30)
```bash
# 1. 로그 확인
tail -n 50 logs/crawler/stdout.log

# 2. 데이터 확인
sqlite3 data/rankings.db "
SELECT platform, COUNT(*)
FROM rankings
WHERE date = '$(date +%Y-%m-%d)'
GROUP BY platform;
"

# 3. Health check
python3 scripts/health_check.py
```

### 주간 (매주 월요일)
```bash
# 1. DB 백업
./scripts/backup_db.sh

# 2. 로그 정리
find logs/ -name "*.log" -mtime +30 -delete

# 3. 디스크 공간 확인
df -h
```

---

## 10. Phase 2 구현 TODO (맥북에서)

### 우선순위 1: Launchd 설정
- [ ] `config/launchd/com.riverse.webtoon.plist` 생성
- [ ] `scripts/setup_launchd.sh` 생성
- [ ] 테스트 및 검증

### 우선순위 2: Health Check
- [ ] `scripts/health_check.py` 생성
- [ ] DB 상태 체크
- [ ] 디스크 공간 체크
- [ ] 로그 파일 크기 체크

### 우선순위 3: 로깅 구성
- [ ] `config/logging/logging.yaml` 생성
- [ ] JSON 포맷 로그
- [ ] Rotating file handler
- [ ] 에러 로그 분리

### 우선순위 4: 자동 백업
- [ ] `scripts/backup_db.sh` 생성
- [ ] Cron 또는 Launchd로 자동화
- [ ] 30일 이상 백업 자동 삭제

---

## 11. 유용한 명령어

```bash
# 크롤러 실행
python3 crawler/main.py

# 대시보드 실행
streamlit run dashboard/app.py

# DB 확인
sqlite3 data/rankings.db ".tables"
sqlite3 data/rankings.db "SELECT * FROM rankings LIMIT 5;"

# 로그 확인
tail -f logs/crawler/stdout.log

# Launchd 상태 확인
launchctl list | grep webtoon

# Launchd 재시작
launchctl unload ~/Library/LaunchAgents/com.riverse.webtoon.plist
launchctl load ~/Library/LaunchAgents/com.riverse.webtoon.plist
```

---

## 12. 연락처

**문제 발생 시**:
- GitHub Issues: https://github.com/your-username/webtoon_ranking_for_claude/issues
- 이메일: your-email@example.com

---

**현재 상태**: Phase 1 완료 (에이전트 시스템 구축)
**다음 단계**: Phase 2 (macOS 24/7 운용 설정)
